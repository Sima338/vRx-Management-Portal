<vrx-page-container 
  title="Security Findings" 
  subtitle="Vulnerability reports and security analysis">
  
  <div class="findings-content">
    
    <!-- Error Display -->
    <div *ngIf="error()" class="error-message">
      <span>{{ error() }}</span>
      <button class="retry-btn" (click)="loadFindings()">Retry</button>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card total">
        <div class="stat-number">{{ stats().total }}</div>
        <div class="stat-label">Total Findings</div>
      </div>
      <div class="stat-card critical">
        <div class="stat-number">{{ stats().critical }}</div>
        <div class="stat-label">Critical</div>
      </div>
      <div class="stat-card high">
        <div class="stat-number">{{ stats().high }}</div>
        <div class="stat-label">High</div>
      </div>
      <div class="stat-card open">
        <div class="stat-number">{{ stats().open }}</div>
        <div class="stat-label">Open</div>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters-section">
      <div class="filter-group">
        <label for="severityFilter">Filter by Severity:</label>
        <select id="severityFilter" [(ngModel)]="selectedSeverity" (ngModelChange)="onFilterChange()" class="filter-select">
          <option value="all">All Severities</option>
          <option value="critical">Critical</option>
          <option value="high">High</option>
          <option value="medium">Medium</option>
          <option value="low">Low</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="statusFilter">Filter by Status:</label>
        <select id="statusFilter" [(ngModel)]="selectedStatus" (ngModelChange)="onFilterChange()" class="filter-select">
          <option value="all">All Statuses</option>
          <option value="open">Open</option>
          <option value="investigating">Investigating</option>
          <option value="resolved">Resolved</option>
          <option value="false_positive">False Positive</option>
        </select>
      </div>

      <div class="filter-actions">
        <vrx-button 
          variant="secondary" 
          (clicked)="clearFilters()">
          Clear Filters
        </vrx-button>
      </div>
    </div>

    <!-- Findings Table -->
    <div class="table-section">
      <div *ngIf="loading()" class="loading-state">
        <div class="loading-spinner"></div>
        <span>Loading findings...</span>
      </div>
      
      <vrx-table 
        *ngIf="!loading()"
        [columns]="tableColumns"
        [data]="filteredFindings()"
        [actions]="tableActions"
        [showSearch]="true"
        [searchPlaceholder]="'Search'"
        [searchColumns]="['title', 'description']"
        (actionClicked)="handleTableAction($event)">
      </vrx-table>
    </div>

  </div>
</vrx-page-container>
